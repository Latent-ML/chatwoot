<script setup>
import { computed } from 'vue';
import Icon from 'dashboard/components-next/icon/Icon.vue';
import { useDropdownContext } from './provider.js';

const props = defineProps({
  label: { type: String, default: '' },
  icon: { type: [String, Object, Function], default: '' },
  link: { type: String, default: '' },
  click: { type: Function, default: null },
  disabled: { type: Boolean, default: false },
  preserveOpen: { type: Boolean, default: false },
});
const emit = defineEmits(['click']);

defineOptions({
  inheritAttrs: false,
});

const { closeMenu } = useDropdownContext();

const componentIs = computed(() => {
  if (props.link) return 'router-link';
  if (props.click) return 'button';

  return 'div';
});

const triggerClick = () => {
  emit('click');
  if (props.click) props.click();
  if (!props.preserveOpen) closeMenu();
};
</script>

<template>
  <li class="n-dropdown-item">
    <component
      :is="componentIs"
      v-bind="$attrs"
      class="flex text-left rtl:text-right items-center p-2 reset-base text-sm w-full"
      :class="{
        'hover:bg-n-alpha-1 rounded-lg w-full gap-3': !$slots.default,
        'pointer-events-none text-n-slate-11': props.disabled,
        'text-n-slate-12': !props.disabled,
      }"
      :href="props.link || null"
      @click.stop="triggerClick"
    >
      <slot>
        <slot name="icon">
          <Icon v-if="icon" class="size-4 text-n-slate-11" :icon="icon" />
        </slot>
        <slot name="label">{{ label }}</slot>
      </slot>
    </component>
  </li>
</template>
